pipeline { 
  agent {
    kubernetes {
      cloud 'local'
      inheritFrom 'podman'
    }
  }
  stages {
      stage('Parus Web Extra Build') {
       steps {
         container ('podman') {
           script {
             sh "curl -k -o dockerfiles/web2/extra.zip  \
                 nexus-nexus-repository-manager.nexus:8081/repository/parus/service/8.561-0823/extra.zip"
//             withEnv(['EDITIONz = env.BUILD_NUMBER']) {
//               sh "podman build --tls-verify=false -t parusweb2:8:5:6:1:${EDITION} dockerfiles/web2/. && podman push --creds=jenkins:jenkins --tls-verify=false  nexus-nexus-repository-manager-docker-5000.nexus:5000/parusweb2:8:5:6:1:${EDITION}"
//             }
sh "podman build -t parusweb2:8:5:6:1:${EDITION} dockerfiles/web2/. && \
podman push --creds=jenkins:jenkins --tls-verify=false \
nexus-nexus-repository-manager-docker-5000.nexus:5000/parusweb2:8:5:6:1:${BUILD_NUMBER}"

           }
         }
       }
      }
//      stage("Quality Gate") {
//            steps {
//            }
//      }
  }
}